# 任务书

## 一 总体要求

1. 综合运用软件工程的思想，协同完成一个软件项目的开发，掌软件工程相关的技术和方法；

2. 组成小组进行选题，通过调研完成项目的需求分析，并详细说明小组成员的分工、项目的时间管理等方面。

3. 根据需求分析进行总体设计、详细设计、编码与测试等。

## 二 基本内容

根据给出的题目任选一题，自行组队，设计与开发中软件过程必须包括：

1. **问题概述、需求分析：**正确使用相关工具和方法说明所开发软件的问题定义和需求分析，比如NABCD模型，Microsoft Visio，StarUML等工具 (20%)；

2. **原型系统设计、概要设计、详细设计**：主要说明所开发软件的架构、数据结构及主要算法设计，比如墨刀等工具（35%）；

3. **编码与测试**：编码规范，运用码云等平台进行版本管理，设计测试计划和测试用例（30%）；
4. **功能创新**：与众不同、特别吸引用户的创新（10%）；

5. **用户反馈**：包括用户的使用记录，照片，视频等（5%）。

# MuiOJ在线评测系统

## 问题定义

### 项目背景与意义

- 现行OJ平台UI不够现代化，用户追求更好的UI界面；功能过于臃肿不利于用户选择；大量用户集中使用几个OJ平台导致高并发运行时运行速度过慢。设计一个观赏性和性能更加的在线评测系统，对于提升用户体验来说具有重要意义。

#### 用户需求

- 多数OJ的UI界面比较成熟，但不够现代化。
- 大多数OJ平台功能更加丰富，但对于大多数受众来说功能过于臃肿。
- 使用高峰期评测系统效率低下。

#### 解决方案

- 创建一个实现主流编程语言编译运行功能的web应用。
- 重设页面分区。
- 优化后端并行调度。

#### 产品优势

- 具有更加美观的UI界面。
- 覆盖语言不多但是足以满足大多数人的需求。
- 针对受众不广，OJ性能得到进一步保证。

#### 市场竞争

- 现行OJ用户交互功能更加完善，诸如评论区等功能，后期看进度再进行完善。
- 题库覆盖更加全面，有更好的阶段性做题索引。

#### 产品推广

- 在班级，系内做广。
- 和学院合作。
- 给予用户良好的印象，让用户口口相传，让更多的非用户自然地成为用户。

### 项目基本目标

- 实现用户管理系统。包括用户注册，信息增删查改，用户注销功能。
- 实现代码在线编译。包括代码高亮实现，编译实现，在线编辑和题目评测功能实现。
- 实现提交结果展示功能，OJ优化更新公告界面。
- 在实现上述功能基础下，后续开放竞赛模块，逐步实现评论区、排行榜等功能。

### 可行性分析

通过以上的NABCD模型分析可以看出，我们的产品是基于用户的需求出发设计，因此更能满足用户的需求并为用户带来便利，同时也改善了现有OJ的一些不足之处。在对目前大多数同类产品分析来看，我们的产品具有独特的创新点，所以在市场方面我们面向用户的出发点具有一定的可行性。同时在实现方面，基于项目要实现的基本目标和思维导图，我们可以很快的用react框架构建出前端网页。基于VS Code的语法编辑和代码高亮可以很方便的为我们解决编译器实现问题，而用户数据管理以及相关测评数据管理等后端操作事项有PHP,Python（flask框架），java(ssm框架）等方向来实现。因此总体来看我们的产品具有较高的可行性。

### 人员管理和项目进度管理

#### 人员管理

小组成员有: 谭滨瀚, 施远栋, 王艳, 许楚辉, 分工如下:

- 谭滨瀚: 负责实现后端数据库的表项定义,后端服务与数据库的连接,提供后端接口与前端交互,同时提供认证功能
- 王艳：负责前端框架搭建，实现题库展示，代码编辑提交功能，用户信息页面；修改登录注册功能等；以及数据与后端的联调
- 施远栋: 负责部分题库数据集的清洗及导出，负责网站主页及提交记录页面的实现
- undo
- 许楚辉：负责部分题库数据集的清洗及导出，协助网页前端开发

#### 项目进度管理

首先根据项目的需求对功能进行了分解，具体分解到大约30个任务点。然后使用甘特图对小组每个成员的任务进度安排进行了大致的划分，对完成时长以及完成时间提出了一定的要求，完成对项目进度的规划。再使用Gitee上的issue功能，在其中发布任务、认领任务并完成任务，每周周三进行一次腾讯会议，每周末进行一次线下会议，实时交流任务进度，交流对项目任务开展的看法，实现对进度的实时管理。

## 需求分析

### E-R图

### 数据流图

### 用例图

![image-20211227211821396](https://s2.loli.net/2021/12/27/h9McVmtE3kWazsj.png)

### 原型系统设计

运用工具设计原型系统，从而更准确说明主要功能和用户交互界面。

#### 原型设计工具

我们小组的原型系统设计采用了在线平台ProcessOn和墨刀免费版。

#### 原型设计思路

我们小组参考了各大OJ平台的界面设计，结合同学和自己的理解，我们认为简洁明了的环境最适合我的项目。所以，在设计中我们采用尽量精简的元素数量，只是对单个元素进行美化，使得我们的界面简洁而又不失美感。

#### 原型设计成果

首先是注册界面的原型图：

![image-20211228221617647](https://gitee.com/xu_chu_hui/picture/raw/master/img/image-20211228221617647.png)

其次是登录界面：

![image-20211228221559648](https://gitee.com/xu_chu_hui/picture/raw/master/img/image-20211228221559648.png)

登录的时候可以选择以用户名的方式登录或者以邮箱的方式登录。

接下来是主要页面，分别是首页原型图：

![image-20211228221509530](https://gitee.com/xu_chu_hui/picture/raw/master/img/image-20211228221509530.png)

题库原型图：

![image-20211228221434728](https://gitee.com/xu_chu_hui/picture/raw/master/img/image-20211228221434728.png)

题目原型图：

![image-20211228221748507](https://gitee.com/xu_chu_hui/picture/raw/master/img/image-20211228221748507.png)

提交界面原型图：

![image-20211228221849351](https://gitee.com/xu_chu_hui/picture/raw/master/img/image-20211228221849351.png)

## 概要设计和详细设计

### 系统结构

#### FrontEnd
#### 前端系统分为9个模块：
1. 注册账号模块。注册功能分为六个步骤，填入用户名、填入密码、点击注册按钮、传递用户信息的后端管理判断、后台返回响应。
2. 账号登录模块。登录支持用户名密码登录和邮箱密码登录。主要的登录功能分为五个步骤，填入用户名、填入密码点击登录按钮、传递用户信息的后端管理判断，后台返回响应：若为已注册用户则登录成功，若为未注册账号则自动跳转到注册页面。
3. 用户退出登录模块：清楚token记录并跳转到登录页面。
4. 登录拦截模块。该模块主要实现未登录拦截，若用户处于未登录状态将无法跳转到题库等页面。
5. OnlineJudge主界面模块。主要功能：公告栏展示近期的更新的信息或者链接。
6. OnlineJudge题库模块：从后端获取所有题目数据，并展示在页面上，考虑到题目数量过多，有分页功能；并且点击题目可以跳转到题目详情页。
7. OnlineJudge题目编辑模块：根据题目id跳转到相应页面。题目编辑页面分为：题目信息展示，输入例子展示，输出例子展示，以及monaco编辑区，提交题目按按钮，点击按钮将用户编辑的数据传回后端处理并返回。
8. OnlineJudge提交记录展示：提交记录展示主要步骤：前端展示后端处理数据的结果，展示用户提交的题目ID、运行的结果为AC或者CE、运行时间、运行所占内存、使用的语言、以及提交的时间；同样实现了分页功能；
9. OnlineJudge个人信息模块。主要功能：展示用户的用户名、用户ID、用户头像、用户邮箱，以及是否为管理员，算法题目总的提交次数，以及题目的总通过次数。提供给所有用户跳转到其他页面的按钮。。


#### BackEnd

#### 类图

undo

### 关键数据定义

#### 前端数据结构
1. 登入界面主要数据：username、password分别绑定前端页面的用户名输入框和密码输入框中的内容，并通过基于Promise的fetch方法打包传递给后端服务器。
2. 注册界面主要数据：username、password、repassword分别绑定前端页面的用户名输入框和密码输入框、确认密码输入框中的内容，并并通过基于Promise的fetch方法打包传递给后端服务器。
3. 题库页面主要数据：problemList是一个具体的字典数组，数组中元素是用来存储每门课的基本信息的，数组元素具体格式如下：
problemList[ {
tid:" ",
title:" ",
attempt:" ",
}
]
name表示算法题的ID，title表示算法题的题目，attempt表示当前用户对于该道题的提交次数;
4. 题目编辑页面主要数据：data是一个具体的字典数组，数组中元素是用来存储用户讨论的基本信息的，数组元素具体格式如下：
 >const [data, setData] = useState(
    {
      content: '',
      accept: 0,
      create_at: '',
      sampleIn: '',
      sampleOut: ''
    })
>
content用来表示题目信息，accept用来表示用户通过次数，create_at用来表示题目提交时间，sampleIn用来表示该提的输入样例，sampleOut用来表示输出样例;
5. 个人信息界面主要数据：rows是用户信息展示的所需的数据，具体如下：
> const rows = [
    createData('用户名', user?.username),
    createData('用户ID', user?.uid?.toString()),
    createData('用户邮箱', '3313696160@qq.com'),
    createData('是否管理员', user?.is_admin?.toString() === 'true' && '是' || "否")
    createData('提交次数', data.message.attempt.toString())
    createData('通过次数', data.message.accept.toString())
];
>
此处引入了Mui Table的组件
6. 首页主要数据：const rows 为要现实的数据的集合

  每个row由下述函数获得

  createData(

   Notice: string,  

   Way: string,

   Uploader: string,

   Date: string,

  ) {

   *return* { Notice, Way, Uploader, Date };

  }

7. 提交记录页面主要数据：
    数据结构为

  const rows=[ 

  createData(

  ​    item.question_title,

  ​    item.status,

  ​    item.time_used,

  ​    item.space_used,

  ​    item.language,

  ​    item.created_at

     )

  ]


#### 数据库表项设计

#### 数据关联结构设计

### 关键算法设计

undo

## 实现与测试

### 实现环境与代码管理

#### 实现环境

- 计算机环境：

  处理器：lntel(R) Core(TM) i7-9750H CPU @ 2.60GHz

  内存（RAM）：16.00GB

  操作系统：Windows10  X64 64位操作系统

- 编译环境：

  Pycharm、Goland、VScode

- 实现语言：

  html+css+js+go+ts+python

- 实现框架：

  前端：React

#### 代码管理
##### 整体代码管理使用Gitee进行管理，整体通过vscode终端进行git push、pull、add、commit、fetch、remote、branch等一系列操作进行管理。gitee页面如下图：

![image-20211227220319005](https://s2.loli.net/2021/12/27/sM4FlU2LYOzDaoy.png)

#### 关键实现说明

undo

### 测试计划和测试用例

#### 测试计划

#### 测试用例

### 结果分析
1. 注册数据结构的使用结果分析
-  用户注册测试一:
   在注册界面，注册一个新用户，此时用户名为wadwings，密码为wadwings，邮箱为   2313686160@qq.com注册成功后，弹框显示注册成功样式。查看数据库，可以发现数据库中能够正常存储用户的信息。


-  用户注册测试二:
   当重复注册时，调用添加用户的接口函数，会显示用户名已注册。

-  数据库更新后的信息如下:

2. 登录数据结构的使用结果分析
-  用户登录测试一：
   在登录界面，用户点击用户名登录，输入已注册的用户名和密码。登录成功后，弹框显示登录成功 样式，前端获取token并进行存储，并跳转到主页。查看数据库，可以发现数据库中能够正常存储用户的信息。如下图：
   <img src="https://gitee.com/fspz/pic-go-relate/raw/master/img/login.png" alt="image-20211227231435418" style="zoom:80%;" />

- 用户登录测试二：
  在登录界面，用户点击用邮箱登录，输入已注册的邮箱账号和密码。登录成功后，弹框显示登录成功样式，前端获取token并进行存储，并跳转到主页。查看数据库，可以发现数据库中能够正常存储用户的信息。如下图：
  <img src="https://gitee.com/fspz/pic-go-relate/raw/master/img/login2.png" alt="image-20211227231529959" style="zoom:80%;" />

- 用户登录测试三：
  在登录界面，用户输入未注册的账号或者邮箱，系统会提示登录失败。如下图：
  <img src="https://gitee.com/fspz/pic-go-relate/raw/master/img/login4.png" alt="image-20211227231631469" style="zoom: 67%;" />

- 返回的数据如下：
  <img src="https://gitee.com/fspz/pic-go-relate/raw/master/img/login6.png" alt="image-20211227232041117" style="zoom:80%;" />

- 数据库更新后的信息如下:

3. 题库数据结构的使用结果分析
- 点击题库，跳转题库页面，同时向后端发送携带tid的url的get请求，获取到所有题目数据并渲染到页面上。如下图：
  <img src="https://gitee.com/fspz/pic-go-relate/raw/master/img/data2.png" alt="image-20211227231915914" style="zoom:80%;" />

- 获取到的数据如图：
  ![image-20211227231812510](https://gitee.com/fspz/pic-go-relate/raw/master/img/data1.png)

4. 代码编辑页数据结构的使用结果分析
- 用户随意点击一题，此时便会根据题目ID向后端发送携带tid的url的get请求，获取题目的详细信息，并跳转到代码编辑页面展示题目与代码编辑框，如下图：
  <img src="https://gitee.com/fspz/pic-go-relate/raw/master/img/editor1.png" alt="image-20211227232205461" style="zoom:50%;" />

- 点击提交后，便将代码数据打包向后端发送post请求，后端收到数据后进行处理。如下图：


- 获取到的数据如图：
  <img src="https://gitee.com/fspz/pic-go-relate/raw/master/img/editor2.png" alt="image-20211227232401299" style="zoom:80%;" />

5. 用户信息展示数据结构的使用结果分析
- 点击顶部用户名即可跳转到用户界面，同时向后端发送携带uid的url的get请求，获取到数据后及时渲染到页面上。如下图：
   <img src="https://gitee.com/fspz/pic-go-relate/raw/master/img/user1.png" alt="image-20211227232751515" style="zoom: 67%;" />

- 获取到的数据如图：

  <img src="https://gitee.com/fspz/pic-go-relate/raw/master/img/user0.png" alt="image-20211227232610255"  />

6. 提交记录数据结构的使用和结果分析：

- 点击提交记录查看数据:

  ![image-20211230224805915](https://s2.loli.net/2021/12/30/e5jbcI18MZNWugV.png)

- 获取到的数据如图：

  ![image-20211230224951807](https://s2.loli.net/2021/12/30/uqd8C6mB4YtvDZ7.png)





## 总结

### 用户反馈

#### 用户反馈样例

undo

#### 用户反馈总结
（一）优点
1. OJ系统简洁明了
2. 登录注册功能做了响应式设计，可以适应不同的屏幕大小，用户体验感较好
2. 题目数据丰富，可供用户有多重选择
4. monaco代码编辑区有颜色高亮和提错显示，相较于其他编辑器使用起来更人性化
5. 提交记录展示较为详细，可以看到自己的提交结果，了解自己对哪种题比较熟悉或者不熟悉，方便随时练手

(二）用户建议
 1. OJ主页面内容可以更多样化一些
 2. 编辑页面的布局可以稍微注意下各个组件的间隔问题；
 3. 顶部导航栏居中可能会比靠左对齐更好一点


### 全文总结

undo

## 体会

undo

## 附录

undo